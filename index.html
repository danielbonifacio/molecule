<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Molecule</title>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/winPhoton.css">
    <link rel="stylesheet" href="css/winStyle.css">
    <link rel="stylesheet" href="css/animate.css">

    <!-- Electron Javascript -->
  </head>

  <body>
    <div class="window">
      <div class="loaderbg">
      </div>
      <header class="toolbar toolbar-header">
      <div id="frame">
        <span class="frameless-btn" id="closeWindow"><svg aria-hidden="true" version="1.1" width="10" height="10"><path d="M 0,0 0,0.7 4.3,5 0,9.3 0,10 0.7,10 5,5.7 9.3,10 10,10 10,9.3 5.7,5 10,0.7 10,0 9.3,0 5,4.3 0.7,0 Z"></path></svg></span>
        <span class="frameless-btn" id="maximizeWindow"><svg aria-hidden="true" version="1.1" width="10" height="10"><path d="M 0,0 0,10 10,10 10,0 Z M 1,1 9,1 9,9 1,9 Z"></path></svg></span>
        <span class="frameless-btn" id="minimizeWindow"><svg aria-hidden="true" version="1.1" width="10" height="10"><path d="M 0,5 10,5 10,6 0,6 Z"></path></svg></span>
        <div id="app-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 252.12 206"><g><circle cx="71.49" cy="27.67" r="6.15" width="16" fill="#959da5" /><circle cx="129.9" cy="186.78" r="13.07"/><path d="M252.09,35.05a36.51,36.51,0,0,0-71.82-7.71,13.4,13.4,0,0,1-5.74,7.93,10.86,10.86,0,0,1-11.77,0A71.11,71.11,0,0,0,53.07,92.91h0c-5.34,7.57-14.63,1.63-14.68,1.6a22.29,22.29,0,1,0,2,28.37,13.4,13.4,0,0,1,9.25-5.63l.36,0a8,8,0,0,1,8.36,4.86,71.17,71.17,0,0,0,91.25,39.26,6.48,6.48,0,0,1,8,2.77l.25.43a10.45,10.45,0,0,1,.29,9.71c-3,6.27-3.08,14.15,1.33,22a16.62,16.62,0,0,0,6.32,6.34c21.51,12.11,43.47-9.84,31.38-31.35a16.55,16.55,0,0,0-6.21-6.25,24.85,24.85,0,0,0-14.8-3.42,7.4,7.4,0,0,1-7.08-3.72h0a7.19,7.19,0,0,1,1.5-9,70.93,70.93,0,0,0,24.66-53.84,71.72,71.72,0,0,0-.41-7.66A11.45,11.45,0,0,1,200,76.37l.57-.37A20.4,20.4,0,0,1,213,72.93q1.27.09,2.56.09A36.51,36.51,0,0,0,252.09,35.05Z"/></g></svg>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 250 250" v-if="appIcon == 'alt'"><path d="M125,0A125,125,0,1,0,250,125,125,125,0,0,0,125,0ZM71.82,60.58a5.1,5.1,0,1,1-5.1,5.1A5.1,5.1,0,0,1,71.82,60.58Zm48.46,147.93a10.84,10.84,0,1,1,10.84-10.84A10.84,10.84,0,0,1,120.28,208.51Zm71.1-105.21q-1.07,0-2.12-.07a16.92,16.92,0,0,0-10.36,2.55l-.48.3a9.5,9.5,0,0,0-4.28,9,59.53,59.53,0,0,1,.34,6.35A58.84,58.84,0,0,1,154,166.13a6,6,0,0,0-1.24,7.5h0a6.14,6.14,0,0,0,5.87,3.09,20.62,20.62,0,0,1,12.28,2.84,13.72,13.72,0,0,1,5.15,5.19c10,17.84-8.19,36-26,26a13.79,13.79,0,0,1-5.24-5.26c-3.65-6.5-3.55-13-1.1-18.23a8.67,8.67,0,0,0-.24-8.06l-.21-.36a5.37,5.37,0,0,0-6.61-2.3A59,59,0,0,1,61,144a6.64,6.64,0,0,0-6.94-4l-.29,0a11.11,11.11,0,0,0-7.68,4.67,18.49,18.49,0,1,1-1.69-23.54s7.75,5,12.18-1.32h0a59,59,0,0,1,91-47.85,9,9,0,0,0,9.77,0,11.11,11.11,0,0,0,4.76-6.58,30.29,30.29,0,1,1,29.32,37.89Z"/></svg>
        </div>
        <nav>
          <ul id="main-menu">
            <li @click.stop="openMenu('file')" :class="{ 'menu-active' : menu == 'file'}">Arquivo
              <ul class="hidden-menu" v-if="menu == 'file'" v-click-outside="closeEvent">
                <li @click="createClient">
                  <div class="main-text">
                    Novo cliente
                  </div>
                  <div class="shortcut">
                    Ctrl+N
                  </div>
                </li>
                <div class="divisor"></div>
                <li @click="createProduct">
                  <div class="main-text">
                    Novo produto
                  </div>
                  <div class="shortcut">
                    Ctrl+P
                  </div>
                </li>
                <li @click="createSale">
                  <div class="main-text">
                    Nova venda
                  </div>
                  <div class="shortcut">
                    Ctrl+S
                  </div>
                </li>
              </ul>
            </li>
            <li @click.stop="openMenu('help')">Ajuda
              <ul class="hidden-menu" v-if="menu == 'help'" v-click-outside="closeEvent">
                <li onclick="linkExt('https://danielbonifacio.com.br/')">
                  <div class="main-text">
                    Suporte
                  </div>
                  <div class="shortcut">
                    Janela Web
                  </div>
                </li>
                <li onclick="linkExt('https://danielbonifacio.com.br/')">
                  <div class="main-text">
                    Doar
                  </div>
                  <div class="shortcut">
                    Janela Web
                  </div>
                </li>
                <li onclick="linkExt('https://danielbonifacio.com.br/')">
                  <div class="main-text">
                    Molecule Plus
                  </div>
                  <div class="shortcut">
                    Janela Web
                  </div>
                </li>
              </ul>
            </li>
          </ul>
        </nav> 
      </div>
      <div class="toolbar-actions">
        <div class="tabs-group">
          <div class="tab tab-default" v-bind:class="{ 'tab-active': windowTab=='index' }" @click="tabChange('index')">
            <div class="tab-icon">
              <span class="icon icon-user icon-text"></span>
            </div>
            <div class="tab-fields">
              <div class="tab-desc">
                Adicionar ou editar clientens
              </div>
              <div class="tab-title">
                Clientes
              </div>
            </div>
          </div>
          <div class="tab tab-default" v-bind:class="{ 'tab-active': windowTab=='products' }" @click="tabChange('products')">
            <div class="tab-icon">
              <span class="icon icon-bag icon-text"></span>
            </div>
            <div class="tab-fields">
              <div class="tab-desc">
                Adicionar ou editar produtos
              </div>
              <div class="tab-title">
                Produtos
              </div>
            </div>
          </div>
          <div class="tab tab-default" v-bind:class="{ 'tab-active': windowTab=='sales' }" @click="tabChange('sales')">
            <div class="tab-icon">
              <span class="icon icon-basket"></span>
            </div>
            <div class="tab-fields">
              <div class="tab-desc">
                Adicionar ou editar vendas
              </div>
              <div class="tab-title">
                Vendas
              </div>
            </div>
          </div>
        </div>

        <div v-if="windowTab == 'index'" @click="createClient" class="tab tab-default btn-tab">
          <div class="tab-icon">
            <span class="icon icon-plus icon-text"></span>
          </div>
          <div class="tab-fields">
            <div class="tab-desc">
              Adiciona um cliente ao sistema
            </div>
            <div class="tab-title">
              Adicionar cliente
            </div>
          </div>
        </div>

        <div v-if="windowTab == 'products'" @click="createProduct" class="tab tab-default btn-tab">
          <div class="tab-icon">
            <span class="icon icon-plus icon-text"></span>
          </div>
          <div class="tab-fields">
            <div class="tab-desc">
              Adiciona um produto ao sistema
            </div>
            <div class="tab-title">
              Adicionar produto
            </div>
          </div>
        </div>

        <div v-if="windowTab == 'sales'" @click="createSale" class="tab tab-default btn-tab">
          <div class="tab-icon">
            <span class="icon icon-plus icon-text"></span>
          </div>
          <div class="tab-fields">
            <div class="tab-desc">
              Adiciona uma venda ao sistema
            </div>
            <div class="tab-title">
              Adicionar venda
            </div>
          </div>
        </div>
        <div class="tabs-icons">
            <a onclick="reloadWindow()" id="settingsBtn">
                <span class="icon icon-arrows-ccw"></span>
              </a>
              <a onclick="openSett()" id="settingsBtn">
                <span class="icon icon-cog"></span>
              </a>
        </div>

      </div>
    </header>
      <div class="window-content">
        <div class="pane-group">
          <div class="pane-sm sidebar">
            <ul class="list-group">
              <nav class="nav-group">
                <h5 class="nav-group-title">Apps</h5>
                <a class="nav-group-item active">
                  <span class="icon icon-home"></span>
                  Molecule
                </a>
                <span class="nav-group-item" onclick="whatsApp()">
                  <span class="icon icon-chat"></span>
                  WhatsApp
                </span>
                <span class="nav-group-item" onclick="backUp()">
                  <span class="icon icon-install"></span>
                  Backup
                </span>
                <span class="nav-group-item" onclick="importBackUp()">
                  <span class="icon icon-publish"></span>
                  Importar dados
                </span>
                <span class="nav-group-item" v-bind:class="{ 'active': mode=='dev' }" onclick="developerMode()">
                  <span class="icon icon-code"></span>
                  Modo Desenvolvedor
                </span>
              </nav>
              <li class="list-group-header">
                <input class="main-search" type="text" placeholder="Pesquisar por alguÃ©m" v-model="nomePesquisa">
              </li>
              <ul>

              </ul>
              <div class="clientList">
              <li v-for="c in clientes | filterBy nomePesquisa" class="list-group-item clienteItem" @click="editClient(c)">
                <img v-if="c.genero == 'f'" class="img-circle media-object pull-left" src="img/avatar_woman.png" width="32" height="32">
                <img v-if="c.genero == 'm'"class="img-circle media-object pull-left" src="img/avatar_man.png" width="32" height="32">
                <img v-if="c.genero == 'o'"class="img-circle media-object pull-left" src="img/avatar_other.png" width="32" height="32">
                <div class="media-body">
                  <strong>{{c.nome}}</strong>
                  <p>{{c.telefone}}</p>
                </div>
              </li>
              </div>
          </ul>
          </div>

          <!-- Tab: Products -->
          <div class="pane" v-if="windowTab == 'products'">
          <table class="table tabe-striped">
            <thead>
            <tr>
              <th>Nome</th>
              <th>PreÃ§o</th>
              <th>Qtd.</th>
              <th>AÃ§Ã£o</th>
            </tr>
            </thead>
            <tbody>
            <tr v-for="produto in produtos">
              <td>{{produto.nome}}</td>
              <td>R${{produto.preco | round 2 true}}</td>
              <td v-if="produto.qtd > 0">{{produto.qtd}}</td>
              <td v-if="produto.qtd < 0" style="color: #fff; background: #d35400">{{produto.qtd}}</td>
              <td v-if="produto.qtd == 0" style="color: #fff; background: #2980b9">{{produto.qtd}}</td>
              <td><button class="btn btn-default" @click="editProduct(produto)">Editar</button></td>
            </tr>
            </tbody>
          </table>
          </div>

          <!-- Tab: Sales -->
          <div class="pane" v-if="windowTab == 'sales'">
    			<table class="table tabe-striped">
    				<thead>
    				<tr>
    					<th>Cliente</th>
    					<th>Produto</th>
    					<th>PreÃ§o Un.</th>
    					<th>Qtd.</th>
    					<th>Desconto</th>
    					<th>Total</th>
    					<th>Data</th>
    					<th>AÃ§Ã£o</th>
    				</tr>
    				</thead>
    				<tbody>
    				<tr v-for="venda in vendas">
    					<td>{{venda.cliente}}</td>
    					<td>{{venda.produto}}</td>
    					<td>R${{venda.preco}}</td>
    					<td>{{venda.qtd}}</td>
    					<td>{{venda.desconto}}%</td>
    					<td>R${{venda.qtd*venda.preco - (venda.qtd * (venda.preco / 100 * venda.desconto)) | round 2 true }}</td>
    					<td>{{venda.data}}</td>
    					<td><button class="btn btn-default" @click="editSale(venda)">Editar</button><button class="btn btn-negative" style="margin-left: 5px;" @click="deleteSale(venda)"><span style="color: #fff!important;" class="icon icon-trash"></span></button></td>
    				</tr>
    				</tbody>
    			</table>
    			</div>

          <!-- Tab: Index -->
          <div class="pane" v-if="windowTab == 'index'">
            <table class="table tabe-striped">
              <thead>
                <tr>
                  <th>Nome</th>
                  <th>CPF</th>
                  <th>Telefone</th>
                  <th>AÃ§Ã£o</th>
                </tr>
              </thead>
              <tbody>
                <tr v-for="cliente in clientes">
                  <td>{{cliente.nome}}</td>
                  <td>{{cliente.cpf}}</td>
                  <td>{{cliente.telefone}}</td>
                  <td><button class="btn btn-default" @click="editClient(cliente)">Editar</button></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!--
        Modal para Clientes
      -->

      <div id="modal" v-if="openModal" class="animated jackInTheBox">
        <div class="wrap">
          <div class="title-modal">
            <div class="pane-body">
              <h3 v-if="mode=='cadastro'">Cadastro de Clientes</h3>
              <h3 v-if="mode=='edicao'">Editar Cliente</h3>
            </div>
          </div>
          <form class="pane-body" id="cadastroCliente">
            <div v-if="mode != 'visualizar'">
              <div class="form-group">
                <label for="nome">Nome completo do cliente</label>
                <input type="text" class="form-control" v-model="client.nome" placeholder="Nome Completo" id="nome">
              </div>
              <div class="form-group">
                <label for="cpf"><input type="radio" name="cpfcnpj" value="cpf" v-model="documento" checked>CPF ou <input type="radio" value="cnpj" name="cpfcnpj" v-model="documento">CNPJ do cliente</label>
                <input type="text" class="form-control" v-model="client.cpf" v-if="documento == 'cpf'"  v-mask format="###.###.###-##" placeholder="CPF" id="cpf">
                <input type="text" class="form-control" v-model="client.cpf" v-if="documento == 'cnpj'"  v-mask format="###.###.###/####-##" placeholder="CNPJ" id="cpf">
              </div>
              <div class="form-group">
                <label for="telefone"><input type="radio" name="telcel" value="tel" v-model="numero" checked>Telefone ou <input type="radio" name="telcel" value="cel" v-model="numero">Celular com DDD</label>
                <input type="text" class="form-control" v-model="client.telefone" v-if="numero == 'tel'" v-mask format="## ####-####"  placeholder="Telefone" id="telefone">
                <input type="text" class="form-control" v-model="client.telefone" v-if="numero == 'cel'" v-mask format="## #####-####"  placeholder="Celular" id="telefone">
              </div>
              <div class="form-group form-control">
                <span v-if="mode == 'cadastro'"><input type="radio" name="genero" value="m" v-model="client.genero" checked> Homem <br></span>
                <span v-if="mode == 'edicao'"><input type="radio" name="genero" value="m" v-model="client.genero"> Homem <br></span>
                <input type="radio" name="genero" value="f" v-model="client.genero"> Mulher <br>
                <input type="radio" name="genero" value="o" v-model="client.genero"> Outro<br>
              </div>
              <button type="button" class="btn btn-positive" @click="clientStoreOrUpdate">Cadastrar</button>
              <button type="button" class="btn btn-negative" v-if="mode=='edicao'" @click="clientDelete">Deletar</button>
              <button type="button" class="btn btn-default" @click="openModal = false">Cancelar</button>
            </div>
          </form>
        </div>
      </div>


      <!--
        Modal para produtos
      -->

      <div id="modal" v-if="openModalProduct" class="animated jackInTheBox">
      <div class="wrap">
        <div class="title-modal">
          <div class="pane-body">
            <h3 v-if="mode=='cadastro'">Cadastro de Produto</h3>
            <h3 v-if="mode=='edicao'">Editar Produto</h3>
          </div>
        </div>
        <form class="pane-body" id="cadastroCliente">
        <div class="form-group">
          <label for="nome">Insira o nome do seu produto</label>
          <input type="text" class="form-control" v-model="product.nome" placeholder="Nome" id="nome">
        </div>
        <div class="form-group">
          <label for="custo">Por quanto vocÃª compra este produto?</label>
          <input type="number" class="form-control" v-model="product.custo" placeholder="Custo" id="custo">
        </div>
        <div class="form-group">
          <label for="preco">Por quanto vocÃª quer vender este produto?</label>
          <input type="number" class="form-control" v-model="product.preco" placeholder="PreÃ§o" id="preco">
        </div>
        <div class="form-group">
          <label for="qtd">Que quantidade vocÃª tem no estoque?</label>
          <input type="number" class="form-control" v-model="product.qtd" placeholder="Qtd." id="qtd">
        </div>

        <div id="stats" v-if="product.custo && product.preco" class="animated bounceIn">
          <span class="stats">Lucro por item: R${{product.preco - product.custo}} <br>
          Lucro total: R${{(product.preco - product.custo) * product.qtd}}</span>
        </div>
        <div id="stats" v-if="product.custo && product.preco" class="animated bounceIn">
          <span class="stats" style="background-color: #16a085">Investimento: R${{product.custo * product.qtd}} <br>
          Receita: R${{(product.preco) * product.qtd}}</span>
        </div>

        <button type="button" class="btn btn-positive" @click="productStoreOrUpdate">Cadastrar</button>
              <button type="button" class="btn btn-negative" v-if="mode=='edicao'" id="fechar" @click="productDelete">Deletar</button>
        <button type="button" class="btn btn-default" id="fechar" @click="openModalProduct = false">Fechar</button>

        </form>
      </div>
      </div>


      <!--
          Modal para vendas
      -->
      <div id="modal" v-if="openModalSale" class="animated jackInTheBox">
      <div class="wrap">
        <div class="title-modal">
          <div class="pane-body">
            <h3 v-if="mode=='cadastro'">Cadastro de Vendas</h3>
            <h3 v-if="mode=='edicao'">Editar Venda</h3>
          </div>
        </div>
        <form class="pane-body">
        <div class="form-group">
          <label for="cliente">Selecione um cliente para a venda</label>
          <select class="form-control" v-model="sale.cliente" id="cliente">
            <option selected="selected" disabled="disabled" v-if="mode=='cadastro'">Selecione um cliente</option>
            <option value="{{c.nome}}" v-for="c in clientes">{{c.nome}}</option>
          </select>
        </div>
        <div class="form-group">
          <label for="produto">Selecione um produto cadastrado</label>
          <select class="form-control" v-model="sale.produto" id="produto">
            <option selected="selected" disabled="disabled" v-if="mode=='cadastro'">Selecione um produto</option>
            <option value="{{p.nome}}" v-for="p in produtos">{{p.nome}}</option>
          </select>
        </div>
        <div class="form-group" v-if="mode=='edicao'">
          <label for="preco">PreÃ§o do produto</label>
          <input type="number" class="form-control" v-model="sale.preco" placeholder="PreÃ§o">
        </div>
        <div class="form-group">
          <label for="qtdOrg">Quantidade a ser vendida</label>
          <input type="number" class="form-control" v-model="sale.qtd" id="qtdOrg" placeholder="Qtd.">
        </div>
        <div class="form-group">
          <label for="desconto">Quantos % de desconto na venda?</label>
          <input type="number" class="form-control" v-model="sale.desconto" placeholder="Desconto" id="desconto">
        </div>
        <div class="form-group">
          <label for="data">Data da venda</label>
          <input type="date" class="form-control" v-model="sale.data" id="data">
        </div>
        <button type="button" class="btn btn-positive" @click="saleStoreOrUpdate">Cadastrar</button>
        <button type="button" class="btn btn-default" id="fechar" @click="openModalSale = false">Fechar</button>
        </form>
      </div>
      </div>

      <script src="js/termlib_min.js"></script>

      <script>
        function openSett() {
          const remote = require('electron').remote;
          const BrowserWindow = remote.BrowserWindow;
          var stt = new BrowserWindow({ width: 640, height: 360, frame: false, resize: false });
          stt.loadURL(__dirname + "/settings.html")
          stt.setResizable(false)
      }
      function reloadWindow() {
          var currentWindow = remote.getCurrentWindow();
          currentWindow.reload();
      }
      </script>
    </div>
      <div id="console" v-if="settings.console ==  true">
        <div id="quest" v-if="cmdQuest">{{cmdQuest}}</div>
        <textarea placeholder="Digite um comando" v-on:keyup.enter="consoleMode()" v-model="cmd" :class="{ 'isQuest' : cmdQuest != '' }"></textarea>
        <div id="history">
          <span v-for="item in cmdHistory">{{item.command}} <br></span>
        </div>
        <div id="live" v-if="settings.livePush == true">
          <span v-for="item in liveChange">{{item.detail}} <br></span>
        </div>
      </div>
  </body>
    <script src="app.js"></script>
    <script src="js/vanilla-masker.min.js"></script>
</html>
